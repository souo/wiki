<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-bigdata/hadoop/hadoop-tuning">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.1">
<link rel="alternate" type="application/rss+xml" href="/wiki/blog/rss.xml" title="Dev Wiki RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/wiki/blog/atom.xml" title="Dev Wiki Atom Feed">




<link rel="stylesheet" href="/wiki/katex/katex.min.css"><title data-rh="true">hadoop 性能优化 | Dev Wiki</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="http://souo.gitee.io/wiki/docs/bigdata/hadoop/hadoop-tuning"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="hadoop 性能优化 | Dev Wiki"><meta data-rh="true" name="description" content="Hadoop集群配置如下："><meta data-rh="true" property="og:description" content="Hadoop集群配置如下："><link data-rh="true" rel="canonical" href="http://souo.gitee.io/wiki/docs/bigdata/hadoop/hadoop-tuning"><link data-rh="true" rel="alternate" href="http://souo.gitee.io/wiki/docs/bigdata/hadoop/hadoop-tuning" hreflang="en"><link data-rh="true" rel="alternate" href="http://souo.gitee.io/wiki/docs/bigdata/hadoop/hadoop-tuning" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://undefined-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/wiki/assets/css/styles.a6de386b.css">
<link rel="preload" href="/wiki/assets/js/runtime~main.356aa08e.js" as="script">
<link rel="preload" href="/wiki/assets/js/main.1a942207.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/wiki/"><b class="navbar__title text--truncate">知识库</b></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/wiki/get-started">Get Started</a><a class="navbar__item navbar__link" href="/wiki/docs/welcome">Docs</a><a class="navbar__item navbar__link" href="/wiki/blog">Blog</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">WIKI</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/wiki/docs/java/jvm/jvm-architecture">Java</a></li><li><a class="dropdown__link" href="/wiki/docs/bigdata/hbase/hbase-architecture">BigData</a></li><li><a class="dropdown__link" href="/wiki/docs/math/quick-power">math</a></li><li><a class="dropdown__link" href="/wiki/docs/db/profiling/sql">数据库</a></li><li><a class="dropdown__link" href="/wiki/docs/questions/java/class_file">面试题</a></li></ul></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/wiki/docs/welcome">Getting Started</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/wiki/docs/java/jvm/jvm-architecture">JAVA</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/wiki/docs/db/profiling/sql">DB</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/wiki/docs/bigdata/hbase/hbase-architecture">BIGDATA</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/wiki/docs/bigdata/hbase/hbase-architecture">Hbase</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/wiki/docs/bigdata/hadoop/hadoop-tuning">Hadoop</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/wiki/docs/bigdata/hadoop/hadoop-tuning">hadoop 性能优化</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/wiki/docs/bigdata/spark/turning_spark">Spark</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/wiki/docs/bigdata/raft">一致性算法</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/wiki/docs/math/quick-power">MATH</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/wiki/docs/momd/momd-1">MOMD</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/wiki/docs/NLP/supervised-ml-sentiment-analysis">NLP</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/wiki/docs/git/git-pathspece">GIT</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/wiki/docs/questions/java/class_file">INTERVIEWS</a></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/wiki/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">BIGDATA</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Hadoop</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">hadoop 性能优化</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>hadoop 性能优化指南</h1><p>Hadoop集群配置如下：</p><ul><li>4个工作节点（DataNodes和TaskTrackers），1个主节点（NameNode，SecondaryNameNode和TM JobTracker）：每个芯片2个芯片/ 16个核心AMD Opteron 6386 SE 2.8GHz</li><li>每个节点16 x 8 GB DDR3 1600 MHz ECC RAM</li><li>每个节点8个东芝MK2002TSKB 2TB @ 7200 rpm SATA驱动器</li><li>每个节点1个LSI MegaRAID SAS 9265-8i RAID控制器</li><li>每个节点1 x 1GbE网络接口卡</li><li>Red Hat Enterprise Linux Server release 6.3 (Santiago) ，内核为2.6.32-279.5.2.el6.x86_64</li><li>Java H版本1.7.0_05-b06</li><li>loudera Distribution for Hadoop（CDH）4.0.1</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="确保hadoop-job完成">确保HADOOP JOB完成<a class="hash-link" href="#确保hadoop-job完成" title="Direct link to heading">​</a></h2><p>根据Hadoop工作负载的性质，某些OS参数的默认值和Hadoop配置参数可能导致Map / Reduce任务和/或Hadoop作业失败，或者可能导致性能大幅下降。根据我们对TeraSort工作负载的经验，以下配置参数值得关注：</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="os参数">OS参数<a class="hash-link" href="#os参数" title="Direct link to heading">​</a></h3><ul><li><p>使用ulimit命令配置的默认最大打开文件描述符（FD）数有时会导致FD耗尽，具体取决于Hadoop工作负载的性质。这会导致导致作业失败的异常。我们在本研究的测试集群中将此值设置为32768。</p></li><li><p>在使用开箱即用设置运行Hadoop作业时，可能会发生提取失败。有时这些失败可能是由于net.core.somaxconn Linux内核参数值较低引起的。此参数的默认值为128.如果需要，此值需要增加到足够大的值。我们在测试集群上将其设置为1024。</p></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="hadoop参数">HADOOP参数<a class="hash-link" href="#hadoop参数" title="Direct link to heading">​</a></h3><ul><li><p>根据Hadoop工作负载的性质，Map / Reduce任务可能无法在一段时间内指示其进度，这超过了mapred.task.timeout mapred-site.xml中的Hadoop配置属性设置。默认情况下，此属性设置为600秒。如果需要，应根据工作负载要求增加此属性的值。但请注意，如果由于硬件，群集设置和/或工作负载实施问题而存在任务挂起的真实情况，则将此值增加到异常大的值可能会将其从Hadoop框架中掩盖。这反过来会导致性能下降。</p></li><li><p>如果遇到类似&quot;timeout while waiting for channel to be ready for read/write&quot;的java.net.SocketTimeoutException异常，则hdfs-site中的dfs.socket.timeout和dfs.datanode.socket.write.timeout属性值.xml需要增加到可接受的水平。这里的权衡再次是，与这些属性的值无关的真实超时情况可能会被忽视超过可接受的时间段</p></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="压缩">压缩<a class="hash-link" href="#压缩" title="Direct link to heading">​</a></h2><p>Hadoop支持3种不同级别的压缩 - 输入数据，中间Map输出数据和Reduce输出数据。它还支持多个可用于执行压缩和解压缩的编解码器。一些编解码器具有更好的压缩因子，但压缩和解压缩需要更长的时间。一些编解码器在压缩因子和压缩和解压缩活动的开销之间取得了很好的平衡。 </p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="jvm重用">JVM重用<a class="hash-link" href="#jvm重用" title="Direct link to heading">​</a></h2><p>Hadoop支持名为mapred.job.reuse.jvm.num.tasks的配置参数，该参数控制一次生成的Map / Reduce JVM进程是否被重新用于运行多于1个任务。 此属性可以在mapred-site.xml中找到，此参数的默认值为1，这意味着JVM不会重新用于运行多个任务。 将此值设置为-1表示可以在特定JVM实例上调度无限数量的任务。 启用JVM重用策略可以减少JVM启动和拆除的开销。 它还提高了性能，因为JVM花费较少的时间来解释Java字节码，因为一些早期的任务预计会触发热方法的JIT编译。 预计JVM重用会在存在大量非常短的运行任务的情况下特别受益。 通过启用JVM重用，我们注意到性能提高了近2％。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="hdfs块大小">HDFS块大小<a class="hash-link" href="#hdfs块大小" title="Direct link to heading">​</a></h2><p>每个Map任务都在所谓的输入split上运行。 mapred.min.split.size（mapred-site.xml），dfs.block.size（hdfs-site.xml）和mapred.max.split.size（mapred-site.xml）配置参数决定了输入拆分的大小。 Hadoop工作负载的输入拆分大小和总输入数据大小决定了Hadoop框架生成的Map任务总数。</p><p>如果Hadoop作业产生了大量的Map任务，那么可以尝试使用更大的HDFS块大小。以这种方式减少Map任务的数量可以减少启动和开销的开销。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="map端溢出">Map端溢出<a class="hash-link" href="#map端溢出" title="Direct link to heading">​</a></h2><p>在Map任务运行时，生成的中间输出存储在缓冲区中。此缓冲区是一块保留内存，是Map JVM堆空间的一部分。此缓冲区的默认大小为100 MB。这由io.sort.mb（mapred-site.xml）配置参数的值控制。</p><p>此缓冲区的一部分保留用于存储溢出记录的元数据。默认情况下，它设置为io.sort.mb的0.05（5％），因此它等于5MB。这由mapred-site.xml的io.sort.record.percent配置参数控制。</p><p>每个元数据记录长度为16个字节。因此，总共327680条记录的元数据可以存储在记录缓冲区中。只要缓冲区的输出数据部分或缓冲区的元数据部分达到某个占用阈值，该缓冲区的内容就会溢出到磁盘。默认情况下，受mapred-site.xml的io.sort.spill.percent配置参数控制的此阈值设置为0.8（80％）。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="copy--shuffle-phase-tuning">COPY / SHUFFLE PHASE TUNING<a class="hash-link" href="#copy--shuffle-phase-tuning" title="Direct link to heading">​</a></h2><p>如果在执行完所有Map任务后很快发现Reduce阶段没有完成复制映射输出，那么这可能表示配置不当的集群。复制阶段进展缓慢可能有多种可能的原因：</p><ul><li><p>默认情况下，mapred-site.xml中由mapred.reduce.parallel.copies管理的并行映射输出复制器线程的最大数量设置为5。这可能是复制操作吞吐量的限制因素。</p></li><li><p>TaskTracker级别用于向reducers提供映射输出的最大工作线程数由tasktracker.http.threads管理，默认设置为40。这是一个TaskTracker级别的属性。可以尝试逐步增加该值以查看其对复制阶段的影响。</p></li><li><p>配置参数，例如dfs.datanode.handler.count（在hdfs-site.xml中找到），dfs.namenode.handler.count（在hdfs-site.xml中找到）和mapred.job.tracker.handler.count（找到在mapred-site.xml中）也可以进行探索以进一步微调。</p></li><li><p>避免Reduce端的磁盘溢出的调整可以加快复制阶段。在我们的案例中，它确实是减少副本瓶颈，减缓了复制阶段。</p></li><li><p>与网络硬件相关的瓶颈也可能是一个促成因素。使用像Netperf这样的基准测试，可以确认所有工作节点上的网络带宽处于实际可接受的水平。</p></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="reduce-side-spills">REDUCE-SIDE SPILLS<a class="hash-link" href="#reduce-side-spills" title="Direct link to heading">​</a></h2><p>Reduce阶段对于影响Hadoop工作负载的总执行时间至关重要。根据Hadoop工作负载的性质，Reduce阶段会更加网络密集，并且可能会更加IO密集。毕竟，可能需要复制，聚合/合并，处理可能大量Map任务生成的所有输出，并且可能需要将所有这些数据写回HDFS。因此，根据分配给Hadoop作业的Reduce插槽的总数，Reduce JVM的Java堆要求比Map JVM要求更高，尤其是在考虑最佳性能时。</p><p>Map任务开始完成其工作后，Map输出将按照Reducer进行排序和分区，并写入TaskTracker节点的磁盘。然后将这些Map分区复制到相应的Reducer TaskTrackers。由mapred-site.xml的mapred.job.shuffle.input.buffer.percent配置参数控制的缓冲区，如果足够大，将保存此Map输出数据。否则，Map输出将溢出到磁盘。 mapred.job.shuffle.input.buffer.percent默认设置为0.70。这意味着将保留70％的Reduce JVM堆空间用于存储复制的Map输出数据。当该缓冲器达到某一阈值累计的mapoutput被合并，并溢出到盘（由mapredsite.xml的mapred.job.shuffle.merge.percent属性是0.66默认控制）。</p><p>一旦Reduce-side排序阶段超过Reduce JVM堆的一部分，在将其输入到最终的reduce函数之前由maped-site.xml中mapred.job.red.input.buffer.percent管理的部分可用于保留Map输出。</p><p>mapred.job.reduce.input.buffer.percent参数默认设置为0.0，这意味着所有Reduce JVM堆都被分配给最终的reduce函数。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="jvm-configuration-tuning">JVM CONFIGURATION TUNING<a class="hash-link" href="#jvm-configuration-tuning" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="jvm-flags">JVM FLAGS<a class="hash-link" href="#jvm-flags" title="Direct link to heading">​</a></h3><ul><li><p>AggressiveOpts： 这是一个伞形标志，用于管理JVM是否启用了某些其他优化。这些标志启用的优化可能因JVM版本而异，因此使用此标志进行测试尤为重要，尤其是在系统升级到较新的JVM时。在我们的集群中，我们通过启用积极的优化功能看到了大约3.4％的改进</p></li><li><p>UseCompressedOops - 压缩普通对象指针或简单压缩指针有助于减少64位JVM的内存占用，但代价是总可寻址Java堆空间减少。默认情况下，在较新的Oracle JVM版本中启用此功能。如果正在使用较旧版本的JVM并且禁用了压缩指针，请尝试启用它们。</p></li><li><p>UseBiasedLocking - Oracle HotSpot JDK中的偏向锁定功能可在锁通常无争用的情况下提高性能。通过禁用此功能，我们发现TeraSort性能下降不到1％。请注意，Oracle JDK 7 Update 5上默认启用UseBiasedLocking。</p></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="gc">GC<a class="hash-link" href="#gc" title="Direct link to heading">​</a></h3><p>垃圾收集分析和Map和Reduce JVM的调优不如试验不同的JVM标志那么简单。 但是，如果人们对GC分析和调整非常熟悉，那么通过调整GC行为所获得的收益可以抵消这项工作所涉及的时间和精力。 在与本调优指南中的实验不同的试验台上，我们通过调整Map和Reduce JVM的GC行为观察到了性能的适度改进。 鼓励对GC调整的其他细节感兴趣的读者阅读本文。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="os配置调整">OS配置调整<a class="hash-link" href="#os配置调整" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="transparent-huge-pages">TRANSPARENT HUGE PAGES<a class="hash-link" href="#transparent-huge-pages" title="Direct link to heading">​</a></h3><p>RHEL 6.2及更高版本的透明大页面（THP）功能旨在简化大页面的管理。此功能已经证明可以改善各种应用的开箱即用性能。但是，启用THP功能运行时的Hadoop工作负载已显示由THP功能的压缩过程导致的高内核空间CPU利用率。这可能会导致很大的回归。我们注意到在启用THP的情况下运行TeraSort工作负载时，回归率高达66％。在运行Hadoop工作负载时，如果观察到类似的症状，则需要禁用THP功能。有关其他详细信息，请参阅CDH 4.0.1发行说明<!-- -->[19]<!-- -->中的“CDH4中的已知问题和解决方法”部分。这里的权衡是，如果同一集群上的其他生产应用程序受益于THP，那么它们的性能将受到影响。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="文件系统选择和属性">文件系统选择和属性<a class="hash-link" href="#文件系统选择和属性" title="Direct link to heading">​</a></h3><p>Linux支持的默认文件系统（FS）可能因发行版的分布和版本而异。 鉴于FS的内部结构在连续的基础上进行分析和改进，因此FS的选择会对Hadoop工作负载的性能产生重大影响，尤其是对于IO密集型工作负载。 RHEL 6.3支持EXT4作为默认FS，根据我们过去的经验，我们发现与EXT3 FS相比，它的性能要好得多。</p><p>在没有noatime属性的情况下，每个文件读取操作都会触发磁盘写入操作以维护文件的上次访问时间。 可以通过向数据磁盘的FS挂载选项添加noatime（也暗示nodiratime）属性来禁用此元数据日志记录。 我们注意到使用noatime FS mount属性可以使TeraSort的性能提高29％。</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/wiki/docs/bigdata/hbase/hbase-architecture"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">深入理解HBase架构</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/wiki/docs/bigdata/spark/turning_spark"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Spark 调优</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#确保hadoop-job完成" class="table-of-contents__link toc-highlight">确保HADOOP JOB完成</a><ul><li><a href="#os参数" class="table-of-contents__link toc-highlight">OS参数</a></li><li><a href="#hadoop参数" class="table-of-contents__link toc-highlight">HADOOP参数</a></li></ul></li><li><a href="#压缩" class="table-of-contents__link toc-highlight">压缩</a></li><li><a href="#jvm重用" class="table-of-contents__link toc-highlight">JVM重用</a></li><li><a href="#hdfs块大小" class="table-of-contents__link toc-highlight">HDFS块大小</a></li><li><a href="#map端溢出" class="table-of-contents__link toc-highlight">Map端溢出</a></li><li><a href="#copy--shuffle-phase-tuning" class="table-of-contents__link toc-highlight">COPY / SHUFFLE PHASE TUNING</a></li><li><a href="#reduce-side-spills" class="table-of-contents__link toc-highlight">REDUCE-SIDE SPILLS</a></li><li><a href="#jvm-configuration-tuning" class="table-of-contents__link toc-highlight">JVM CONFIGURATION TUNING</a><ul><li><a href="#jvm-flags" class="table-of-contents__link toc-highlight">JVM FLAGS</a></li><li><a href="#gc" class="table-of-contents__link toc-highlight">GC</a></li></ul></li><li><a href="#os配置调整" class="table-of-contents__link toc-highlight">OS配置调整</a><ul><li><a href="#transparent-huge-pages" class="table-of-contents__link toc-highlight">TRANSPARENT HUGE PAGES</a></li><li><a href="#文件系统选择和属性" class="table-of-contents__link toc-highlight">文件系统选择和属性</a></li></ul></li></ul></div></div></div></div></main></div></div></div>
<script src="/wiki/assets/js/runtime~main.356aa08e.js"></script>
<script src="/wiki/assets/js/main.1a942207.js"></script>
</body>
</html>